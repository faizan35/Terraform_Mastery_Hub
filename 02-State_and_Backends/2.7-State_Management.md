# 2.7 - Latest Updates in Terraform State Management

## 1. **Native S3 State Locking (Terraform v1.10+)**

- **Before:** You needed an external DynamoDB table to handle state locking when using an S3 backend.
- **Now:** Terraform natively supports state locking via S3 using the `use_lockfile = true` setting, eliminating the need for DynamoDB.

## 2. **Visibility into Remote Changes ("Objects have changed outside of Terraform")**

- **Before:** Terraform refreshed state silently, so out-of-band changes were hidden.
- **Now:** Since Terraform v0.15.4 (and enhanced in v1.2+), Terraform explicitly displays when resources were changed outside Terraform during `plan`. This helps users catch unexpected drift.

## 3. **Ephemeral Values for Secure Secrets Handling (Terraform v1.10)**

- **Before:** Sensitive values like secrets were stored in the state or plan, posing security risks.
- **Now:** Terraform 1.10 introduced _ephemeral values_—temporary inputs/outputs or resources that aren’t persisted in state or plan files, enhancing secrets security.

## 4. **Backend Configuration Enhancements (S3 Workspace Key Prefixing)**

- Improvements to S3 backend detailing how workspaces are stored:

  - Terraform now supports customizing **workspace key prefixes**, allowing clearer and standardized naming in state paths (e.g., `env:dev/...`).

## 5. **State Locking Improvements and Force Unlock Handling**

- Terraform continues to refine locking behavior:

  - State locking remains automatic for operations that write state; failures will halt Terraform unless overridden with `-lock=false`.
  - The new `force-unlock` command enables safely unlocking state when necessary.
